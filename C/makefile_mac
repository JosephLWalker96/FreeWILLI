# Compiler and flags
CXX = g++
CXXFLAGS = -std=c++20 -march=native -O3 -g -Wall -flto=auto   # remove -g -Wall for production build
LIBS = -llapack --fftw
INCLUDES = -I/opt/homebrew/Cellar/openblas/0.3.27/include/ -I/opt/homebrew/Cellar/liquid-dsp/1.6.0/include -I/opt/homebrew/Cellar/googletest/1.14.0/include/  -I/opt/homebrew/Cellar/eigen/3.4.0_1/include/ -I/usr/local/bin/sigpack-1.2.7/sigpack #-I/opt/homebrew/opt/fftw/include/

# Directories 
SRC_DIR := src
OBJ_DIR := src

# Source files
SRCS := $(wildcard $(SRC_DIR)/*.cpp)

# Object files
OBJS := $(SRCS:$(SRC_DIR)/%.cpp=$(OBJ_DIR)/%.o)

# Target executable
TARGET := listen

# Make all targets by default
all: $(TARGET)

# Linking target executable
$(TARGET): $(OBJS)
	$(CXX) $(CXXFLAGS) $(OBJS) -o $(TARGET) $(LIBS)

# Compile source files
%.o: %.cpp
	$(CXX) $(CXXFLAGS) $(INCLUDES) -c $< -o $@

# Clean rule
clean:
	rm -f $(OBJS) $(TARGET)

# PHONY targets to prevent conflicts with file names
.PHONY: all clean
